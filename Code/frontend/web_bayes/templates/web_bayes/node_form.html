{% extends "web_bayes/form_base.html" %}

{%block bodytitle %}
{{node}}
{%endblock%}

{%block backlink%}
<a  href="{%url view_network node.network.id %}">Return to Network Definition</a>
{%endblock%}

{% block content %}
<form target="" method="POST">
</span>
<h2> Node Details </h2>
<table>
{{details_form}}
</table>

<h2>Node States</h2>
{{ states_formset.non_form_errors.as_ul }}
<table>
<thead>
  <tr>
    <th>Name</th>
    {% if node.is_root %}
    <th>Probability</th>
    {%endif%}
    <th>Delete</th>
  </tr>
</thead>

{{ states_formset.management_form }}
{% for form in states_formset.forms %}
  <tr class="{% cycle row,alt %}">
  {% for hidden in form.hidden_fields %}
      {{ hidden }}
  {% endfor %}
  
  <td>{{form.name.errors.as_ul}}{{form.name}}{{form.probability.errors.as_ul}}</td>
  {% if node.is_root %}    
  <td>{{form.probability.errors.as_ul}}{{form.probability}}</td> 
  {%else%}
  {{form.probability.as_hidden}}
  {%endif%}
  <td>{%if not forloop.first %}{{form.DELETE}}{%else%}{{form.DELETE.as_hidden}}{%endif%}</td>
  </tr>
{% endfor %}
</table>

{% if not node.is_root%}
<h2>CPT</h2>
{%autoescape off %}
<table>
{{cpt_form}}
</table>
{%endautoescape %}
</form>
{% endif %}

<input type="submit" name="save" Value="Save Changes" />
<a  href="{%url delete_node node.id %}">Delete Node</a>

{%endblock%}
